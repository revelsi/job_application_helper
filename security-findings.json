{"version":"1.99.0","results":[{"check_id":"dockerfile.security.missing-user.missing-user","path":"frontend/Dockerfile","start":{"line":55,"col":1,"offset":1177},"end":{"line":55,"col":35,"offset":1211},"extra":{"metavars":{"$...VARS":{"start":{"line":55,"col":5,"offset":1181},"end":{"line":55,"col":35,"offset":1211},"abstract_content":"[\"nginx\"\"-g\"\"daemon off;\"]"}},"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"nginx\", \"-g\", \"daemon off;\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn","semgrep.dev":{"rule":{"origin":"community","r_id":20148,"rule_id":"AbUN06","rv_id":1032972,"url":"https://semgrep.dev/playground/r/5PTA4lQ/dockerfile.security.missing-user.missing-user","version_id":"5PTA4lQ"}}},"severity":"ERROR","fingerprint":"91437bdeca2cc79ecb7d722c0efaa0f74ebe2f8836bc8c9a707a89dd761b914a9ddcd7529dec04e34380769ab245ce8242ef0f81c976e135138f50559586ea8c_0","lines":"CMD [\"nginx\", \"-g\", \"daemon off;\"]","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":["PartialParsing",[{"path":"frontend/tailwind.config.ts","start":{"line":99,"col":3,"offset":0},"end":{"line":99,"col":19,"offset":16}}]],"message":"Syntax error at line frontend/tailwind.config.ts:99:\n `satisfies Config` was unexpected","path":"frontend/tailwind.config.ts","spans":[{"file":"frontend/tailwind.config.ts","start":{"line":99,"col":3,"offset":0},"end":{"line":99,"col":19,"offset":16}}]},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"yaml.github-actions.security.curl-eval.curl-eval","message":"Internal matching error when running yaml.github-actions.security.curl-eval.curl-eval on .github/workflows/security-scan.yml:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/returntocorp/semgrep\n\nrule yaml.github-actions.security.curl-eval.curl-eval: metavariable-pattern failed when parsing $SHELL's content as Bash: TOTAL_DEP_VULNS=0\n\n# Check Python dependencies\nif [ -f \"backend/safety-report.json\" ]; then\n  PYTHON_VULNS=$(python3 -c \"import json; data = json.load(open('backend/safety-report.json')) if open('backend/safety-report.json') else []; print(sum(1 for vuln in data if vuln.get('severity') in ['high', 'critical']))\" 2>/dev/null || echo 0)\n  \n  if [ \"$PYTHON_VULNS\" -gt 0 ]; then\n    echo \"D[aQyP  PYTHON DEPENDENCY VULNERABILITIES: $PYTHON_VULNS high/critical\"\n    TOTAL_DEP_VULNS=$((TOTAL_DEP_VULNS + PYTHON_VULNS))\n  fi\nfi\n\n# Check Node.js dependencies\nif [ -f \"frontend/npm-audit-report.json\" ]; then\n  NODE_VULNS=$(python3 -c \"import json; data = json.load(open('frontend/npm-audit-report.json')); print(sum(1 for vuln in data.get('vulnerabilities', {}).values() if vuln.get('severity') in ['high', 'critical']))\" 2>/dev/null || echo 0)\n  \n  if [ \"$NODE_VULNS\" -gt 0 ]; then\n    echo \"D[aQyP  NODE.JS DEPENDENCY VULNERABILITIES: $NODE_VULNS high/critical\"\n    TOTAL_DEP_VULNS=$((TOTAL_DEP_VULNS + NODE_VULNS))\n  fi\nfi\n\nif [ \"$TOTAL_DEP_VULNS\" -gt 0 ]; then\n  echo \"R`TL Total dependency vulnerabilities: $TOTAL_DEP_VULNS\"\n  echo \"R`UN Review dependency reports for details.\"\n  \n  # Only fail if explicitly configured to block\n  if [ \"${{ secrets.BLOCK_ON_DEPENDENCIES }}\" = \"true\" ]; then\n    echo \"R`\\R BLOCKING: Repository configured to block on dependency vulnerabilities.\"\n    exit 1\n  fi\nelse\n  echo \"D]F No high/critical dependency vulnerabilities found.\"\nfi\n","path":".github/workflows/security-scan.yml"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/security-scan.yml","start":{"line":100,"col":14,"offset":2721},"end":{"line":103,"col":94,"offset":3014}},{"path":".github/workflows/security-scan.yml","start":{"line":110,"col":7,"offset":2721},"end":{"line":110,"col":10,"offset":2724}}]],"message":"Syntax error at line .github/workflows/security-scan.yml:100:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `i CRITICAL SECURITY VULNERABILITIES FOUND: $CRITICAL_COUNT\"\n    echo \"D[aQyP  WARNING: Security issues detected but not blocking push.\"\n    echo \"R`TL Please review findings in the security reports.\"\n    echo \"R`UN To block pushes on critical findings, set BLOCK_ON_CRITICAL=true in repository` was unexpected","path":".github/workflows/security-scan.yml","spans":[{"file":".github/workflows/security-scan.yml","start":{"line":100,"col":14,"offset":2721},"end":{"line":103,"col":94,"offset":3014}},{"file":".github/workflows/security-scan.yml","start":{"line":110,"col":7,"offset":2721},"end":{"line":110,"col":10,"offset":2724}}]}],"paths":{"scanned":[".cursorignore",".dockerignore",".gitattributes",".github/workflows/security-scan.yml",".gitignore",".semgrep.yml",".semgrepignore","LICENSE","README.md","backend/.gitignore","backend/.python-version","backend/API_REFERENCE.md","backend/Dockerfile","backend/env.example","backend/pyproject.toml","backend/run_scripts.sh","backend/scripts/evaluate_system.py","backend/scripts/list_documents.py","backend/scripts/status.py","backend/src/__init__.py","backend/src/api/__init__.py","backend/src/api/endpoints/__init__.py","backend/src/api/endpoints/chat.py","backend/src/api/endpoints/documents.py","backend/src/api/endpoints/health.py","backend/src/api/endpoints/keys.py","backend/src/api/endpoints/models.py","backend/src/api/endpoints/ollama.py","backend/src/api/main.py","backend/src/api/models.py","backend/src/core/__init__.py","backend/src/core/credentials.py","backend/src/core/document_manager.py","backend/src/core/document_processor.py","backend/src/core/llm_providers/__init__.py","backend/src/core/llm_providers/base.py","backend/src/core/llm_providers/factory.py","backend/src/core/llm_providers/mistral_provider.py","backend/src/core/llm_providers/model_config.py","backend/src/core/llm_providers/novita_provider.py","backend/src/core/llm_providers/ollama_provider.py","backend/src/core/llm_providers/openai_provider.py","backend/src/core/memory_manager.py","backend/src/core/prompts.py","backend/src/core/query_analyzer.py","backend/src/core/simple_chat_controller.py","backend/src/core/simple_document_handler.py","backend/src/core/simple_document_service.py","backend/src/core/storage.py","backend/src/ui/__init__.py","backend/src/utils/__init__.py","backend/src/utils/config.py","backend/src/utils/logging.py","backend/src/utils/security.py","backend/start_api.py","backend/tests/test_api_endpoints.py","backend/tests/test_credentials.py","backend/tests/test_document_manager.py","backend/tests/test_llm_client.py","backend/tests/test_memory_manager.py","backend/tests/test_prompts.py","backend/tests/test_query_analyzer_integration.py","docker-compose.yml","frontend/.dockerignore","frontend/.gitignore","frontend/.nvmrc","frontend/Dockerfile","frontend/components.json","frontend/eslint.config.js","frontend/index.html","frontend/nginx.conf","frontend/package-lock.json","frontend/package.json","frontend/postcss.config.js","frontend/src/App.css","frontend/src/App.tsx","frontend/src/components/ApiKeysSetup.tsx","frontend/src/components/ApiStatus.tsx","frontend/src/components/ChatInterface.tsx","frontend/src/components/CompactSessionManager.tsx","frontend/src/components/DocumentUpload.tsx","frontend/src/components/ui/accordion.tsx","frontend/src/components/ui/alert-dialog.tsx","frontend/src/components/ui/alert.tsx","frontend/src/components/ui/aspect-ratio.tsx","frontend/src/components/ui/avatar.tsx","frontend/src/components/ui/badge.tsx","frontend/src/components/ui/breadcrumb.tsx","frontend/src/components/ui/button.tsx","frontend/src/components/ui/calendar.tsx","frontend/src/components/ui/card.tsx","frontend/src/components/ui/carousel.tsx","frontend/src/components/ui/chart.tsx","frontend/src/components/ui/checkbox.tsx","frontend/src/components/ui/collapsible.tsx","frontend/src/components/ui/command.tsx","frontend/src/components/ui/context-menu.tsx","frontend/src/components/ui/dialog.tsx","frontend/src/components/ui/drawer.tsx","frontend/src/components/ui/dropdown-menu.tsx","frontend/src/components/ui/form.tsx","frontend/src/components/ui/hover-card.tsx","frontend/src/components/ui/input-otp.tsx","frontend/src/components/ui/input.tsx","frontend/src/components/ui/label.tsx","frontend/src/components/ui/menubar.tsx","frontend/src/components/ui/navigation-menu.tsx","frontend/src/components/ui/pagination.tsx","frontend/src/components/ui/popover.tsx","frontend/src/components/ui/progress.tsx","frontend/src/components/ui/radio-group.tsx","frontend/src/components/ui/resizable.tsx","frontend/src/components/ui/scroll-area.tsx","frontend/src/components/ui/select.tsx","frontend/src/components/ui/separator.tsx","frontend/src/components/ui/sheet.tsx","frontend/src/components/ui/sidebar.tsx","frontend/src/components/ui/skeleton.tsx","frontend/src/components/ui/slider.tsx","frontend/src/components/ui/sonner.tsx","frontend/src/components/ui/switch.tsx","frontend/src/components/ui/table.tsx","frontend/src/components/ui/tabs.tsx","frontend/src/components/ui/textarea.tsx","frontend/src/components/ui/toast.tsx","frontend/src/components/ui/toaster.tsx","frontend/src/components/ui/toggle-group.tsx","frontend/src/components/ui/toggle.tsx","frontend/src/components/ui/tooltip.tsx","frontend/src/components/ui/use-toast.ts","frontend/src/hooks/use-mobile.tsx","frontend/src/hooks/use-toast.ts","frontend/src/hooks/useApiKeys.ts","frontend/src/index.css","frontend/src/lib/api.ts","frontend/src/lib/config.ts","frontend/src/lib/utils.ts","frontend/src/main.tsx","frontend/src/pages/Index.tsx","frontend/src/pages/NotFound.tsx","frontend/src/vite-env.d.ts","frontend/tailwind.config.ts","frontend/tsconfig.app.json","frontend/tsconfig.json","frontend/tsconfig.node.json","frontend/vite.config.ts","launch_app-uv.sh","launch_app.bat","security-scan.sh","setup-docker-env.sh","setup-local-ollama.sh","setup-uv.sh","setup.bat","start-containers.bat","start-containers.sh"]},"interfile_languages_used":[],"skipped_rules":[]}